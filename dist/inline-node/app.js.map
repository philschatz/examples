{"version":3,"file":null,"sources":["../../inline-node/app.js"],"sourcesContent":["import {\n  Component, ProseEditor, ProseEditorConfigurator, EditorSession,\n  ProseEditorPackage, InlineNode, InsertInlineNodeCommand, EditInlineNodeCommand,\n  AnnotationTool, Tool, deleteSelection, substanceGlobals\n} from 'substance'\n\nsubstanceGlobals.DEBUG_RENDERING = true;\n\n/*\n  Node definition\n*/\nclass InlineImage extends InlineNode {}\n\nInlineImage.define({\n  type: 'inline-image',\n  src: { type: 'string', 'default': './assets/smile.png'}\n})\n\n/*\n  Node display component\n*/\nclass InlineImageComponent extends Component {\n  didMount() {\n    this.context.editorSession.onRender('document', this.rerender, this, {\n      path: [this.props.node.id, 'src']\n    })\n  }\n\n  dispose() {\n    this.context.editorSession.off(this)\n  }\n\n  render($$) {\n    let el = $$('img')\n      .attr('src', this.props.node.src)\n      .addClass('sc-inline-image');\n    return el;\n  }\n}\n\n/*\n  Edit the src of an existing inline image\n*/\nclass EditInlineImageTool extends Tool {\n\n  getUrlPath() {\n    let propPath = this.constructor.urlPropertyPath\n    return [this.props.node.id].concat(propPath)\n  }\n\n  render($$) {\n    let Input = this.getComponent('input')\n    let Button = this.getComponent('button')\n    let el = $$('div').addClass('sc-edit-link-tool')\n    let urlPath = this.getUrlPath()\n\n    el.append(\n      $$(Input, {\n        type: 'url',\n        path: urlPath,\n        placeholder: 'Paste or type an image url'\n      }),\n      $$(Button, {\n        icon: 'delete',\n        style: this.props.style\n      }).on('click', this.onDelete)\n    )\n    return el\n  }\n\n  onDelete() {\n    let editorSession = this.context.editorSession\n    editorSession.transaction(function(tx, args) {\n      return deleteSelection(tx, args)\n    })\n  }\n}\n\nEditInlineImageTool.urlPropertyPath = ['src']\n\n/*\n  Package definition of your inline image plugin\n*/\nconst InlineImagePackage = {\n  name: 'inline-image',\n  configure: function(config) {\n    config.addNode(InlineImage)\n    config.addComponent(InlineImage.type, InlineImageComponent)\n    config.addCommand('add-inline-image', InsertInlineNodeCommand, {nodeType: InlineImage.type})\n    config.addCommand('edit-inline-image', EditInlineNodeCommand, {nodeType: InlineImage.type})\n    config.addTool('add-inline-image', AnnotationTool, { toolGroup: 'insert'})\n    config.addTool('edit-inline-image', EditInlineImageTool, { toolGroup: 'overlay' })\n    config.addIcon('add-inline-image', { 'fontawesome': 'fa-image' })\n    config.addLabel('add-inline-image', 'Inline Image')\n  }\n}\n\n/*\n  Example document\n*/\nconst fixture = function(tx) {\n  let body = tx.get('body')\n  tx.create({\n    id: 'title',\n    type: 'heading',\n    level: 1,\n    content: 'Inline Nodes'\n  })\n  body.show('title')\n  tx.create({\n    id: 'intro',\n    type: 'paragraph',\n    content: \"This shows an inline image $, which behaves like a character in the text.\"\n  })\n  body.show('intro')\n  tx.create({\n    type: 'inline-image',\n    id: 'i1',\n    path: ['intro', 'content'],\n    startOffset: 27,\n    endOffset: 28\n  })\n  tx.create({\n    id: 'the-end',\n    type: 'paragraph',\n    content: \"Yours, Michael $, Oliver $, Daniel $.\"\n  })\n  tx.create({\n    type: 'inline-image',\n    id: 'i2',\n    src: './assets/michael.jpg',\n    path: ['the-end', 'content'],\n    startOffset: 15,\n    endOffset: 16\n  })\n  tx.create({\n    type: 'inline-image',\n    id: 'i3',\n    src: './assets/oliver.jpg',\n    path: ['the-end', 'content'],\n    startOffset: 25,\n    endOffset: 26\n  })\n  tx.create({\n    type: 'inline-image',\n    id: 'i4',\n    src: './assets/daniel.jpg',\n    path: ['the-end', 'content'],\n    startOffset: 35,\n    endOffset: 36\n  })\n  body.show('the-end')\n}\n\n/*\n  Application\n*/\nlet cfg = new ProseEditorConfigurator()\ncfg.import(ProseEditorPackage)\ncfg.import(InlineImagePackage)\n\nwindow.onload = function() {\n  let doc = cfg.createArticle(fixture)\n  let editorSession = new EditorSession(doc, {\n    configurator: cfg\n  })\n  ProseEditor.mount({\n    editorSession: editorSession\n  }, document.body)\n}\n"],"names":["substanceGlobals","InlineNode","Component","Tool","deleteSelection","InsertInlineNodeCommand","EditInlineNodeCommand","AnnotationTool","ProseEditorConfigurator","ProseEditorPackage","EditorSession","ProseEditor"],"mappings":"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"}